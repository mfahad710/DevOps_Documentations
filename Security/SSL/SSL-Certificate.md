# SSL , TLS and mTLS

## Secure Socket Layer ( SSL )

The Secure Socket Layer (SSL) is a cryptographic protocol designed to provide secure communication over a computer network. It was developed by **Netscape** in the **1990s** to establish an encrypted link between the **web server** and a **web browser**. SSL operates by using encryption to secure the transmission of data ensuring that sensitive information such as credit card details and personal data remains confidential.

## Transport Layer Security ( TLS )

The Transport Layer Security (TLS) is the successor to SSL and is designed to provide **improved security** and efficiency. TLS was developed as an enhancement of SSL to the address various vulnerabilities and to the incorporate modern cryptographic techniques. The first version, **TLS 1.0** was based on **SSL 3.0** but included significant improvements. TLS continues to evolve with the newer versions offering enhanced the security features.

## Difference Between SSL and TLS

Both **SSL** and **TLS** are the protocols used to provide security between **web browsers** and **web servers**. The main difference between SSL and TLS is that, in SSL, the Message digest is used to create a master secret and it provides the basic security services which are Authentication and confidentiality. While in TLS, a Pseudo-random function is used to create a master secret.

## SSL/TLS Handshake:
The handshake protocol is basically used between a web client and web server to establish trust and then negotiate what secret key should be used to encrypt and decrypt the conversation.  
TLS handshakes are a series of **datagrams**, or **messages**, exchanged by a client and a server. A TLS handshake involves multiple steps, as the client and server exchange the information necessary for completing the handshake and making further conversation possible.  

![SSL_TLS_Handshake](./SSL_TLS_Handshake.png)

#### Steps

- The client/browser and the server establish a **TCP** connection.
  - client sends a `SYN` packet to initiate connection, the server responds with a `SYN-ACK` to acknowledge and synchronize, and finally the client sends an `ACK` to confirm, establishing a reliable connection.  

- **The 'client hello' message:** The client initiates the handshake by sending a `"hello" message` to the server. The message will include which **TLS version** the client supports, the **cipher suites** supported, and a string of random bytes known as the **"client random"**.

- **The 'server hello' message:** In reply to the client hello message, the server sends a `"hello" message` containing the server's **SSL certificate**, the server's chosen **cipher suite**, and the **"server random"** another random string of bytes that's generated by the server.

- **Authentication:** The client verifies the server's SSL certificate with the certificate authority that issued it. This confirms that the server is who it says it is, and that the client is interacting with the actual owner of the domain.

- **The premaster secret:** The client sends one more random string of bytes, the `"premaster secret"`. The premaster secret is encrypted with the **public key** and can only be decrypted with the **private key** by the server. (The client gets the public key from the server's SSL certificate.)

- **Private key used:** The server decrypts the `premaster secret`.

- **Session keys created:** Both client and server generate `session keys` from the client random, the server random, and the premaster secret. They should arrive at the same results.

- **Client is ready:** The client sends a  `"finished" message` that is encrypted with a session key.

- **Server is ready:** The server sends a `"finished" message` encrypted with a session key.

- **Secure symmetric encryption achieved:** The handshake is completed, and communication continues using the session keys.

## Difference between Self-Signed vs. Paid Certificates

### Paid SSL
To request a paid SSL/TLS certificate from a well-known Certificate Authority (CA) like **Verisign** , **DigiCert** ,  **Sectigo** , **GlobalSign** , **Entrust** , **RapidSSL**

- Create a **Certificate Signing Request (CSR)** with a private key. The CSR includes details about your location, organization, and FQDN (Fully Qualified Domain Name).
- Send the CSR to the **trusted CA**.
- The CA will send you the **SSL certificate**, signed by their root certificate authority, along with a private key.
- Validate and use this SSL certificate with your applications.

### Self-Signed SSL
For a self-signed certificate

- Create your own root CA certificate and CA private key (acting as your own CA).
- Generate a server private key to create a CSR.
- Use the CSR to create an SSL certificate with your root CA and CA private key.
- Install the CA certificate in the browser or operating system to avoid https security warnings.

To learn these practically: [Reference Link](https://devopscube.com/create-self-signed-certificates-openssl/)

Typically, organizations manage their own PKI infrastructure for internal TLS certificate requests.   

![Self-Signed-Certificate](../../Images/Security/Self_Signed_Certificate.png)


## Mutual Transport Layer Security ( mTLS )

mTLS is a security protocol where both the client and server **authenticate** each other before establishing a connection (Meaning both share their Certificate to authenticate each other), as opposed to standard TLS where only the server proves its identity to the client.

How Standard TLS Works, in regular TLS

- Client connects to server
- Server presents its certificate
- Client verifies the server's certificate
- Encrypted connection established

> The client trusts the server, but the server doesn't verify who the client is.

How mTLS Works, in mTLS

- Client connects to server
- Server presents its certificate
- Client verifies the server's certificate
- Server requests the client's certificate
- Client presents its certificate
- Server verifies the client's certificate
- Encrypted connection established with both parties authenticated

![mTLS-Handshake](../../Images/Security/SSL/mTLS-Handshake.png)