# Log Management

## Introduction

Log management is the process of collecting, storing, monitoring, rotating, archiving, and analyzing log data generated by the operating system and applications.

Logs are essential for: Troubleshooting, Security auditing, Performance monitoring, Incident investigation, Compliance requirements

**Default Log Directory**

Most Linux logs are stored in: `/var/log`

To view logs:
```bash
ls -lh /var/log
```

## Important Log Files

#### Debian / Ubuntu Based Systems

| File | Purpose |
|---|---|
| /var/log/syslog | Global system activity logs |
| /var/log/auth.log | Authentication & security logs |
| /var/log/kern.log | Kernel logs |
| /var/log/dmesg | Boot & hardware logs |
| /var/log/cron | Cron job logs |

### RHEL / CentOS / Rocky Based Systems

| File | Purpose |
|---|---|
| /var/log/messages | Global system logs |
| /var/log/secure | Authentication logs |
| /var/log/cron | Cron logs |
| /var/log/boot.log | Boot logs |


## Kernel Logs

#### dmesg
- Used for: - Hardware detection - Driver initialization - Boot messages

#### Authentication Logs

**Debian**: `/var/log/auth.log`  

**RHEL**: `/var/log/secure`

Example:
```bash
grep "Failed password" /var/log/auth.log
```

#### Syslog & rsyslog

It Syslog follows **RFC 5424** format  
Modern systems use rsyslog.

Configuration:
```bash
/etc/rsyslog.conf
/etc/rsyslog.d/
```

Check service: `systemctl status rsyslog`

Example remote forwarding  
`*.* @192.168.1.10:514`

#### systemd-journald

Stores logs in binary format.

- **Location**: `/var/log/journal/`
- **Configuration**: `/etc/systemd/journald.conf`
- **Restart**: `systemctl restart systemd-journald`

#### journalctl Commands

View all logs:
```bash
journalctl
```

Current boot:
```bash
journalctl -b
```

Previous boot:
```bash
journalctl -b -1
```

List boots:
```bash
journalctl --list-boots
```

Since today:
```bash
journalctl --since "today"
```

Service logs:
```bash
journalctl -u nginx
```

Follow logs:
```bash
journalctl -u nginx -f
```

JSON output:
```bash
journalctl -u nginx -r -o json-pretty
```

Filter by priority:
```bash
journalctl -p err
```

## Log Levels

### Syslog Severity Levels

| Level | Number | Description |
|---|---|---|
| EMERG | 0 | System unusable |
| ALERT | 1 | Immediate action required |
| CRIT | 2 | Critical condition |
| ERR | 3 | Error condition |
| WARNING | 4 | Warning |
| NOTICE | 5 | Normal but significant |
| INFO | 6 | Informational |
| DEBUG  | 7 | Debug-level messages |

## Log Rotation

Linux uses logrotate to prevent logs from filling disk space.

Configuration:
```bash
/etc/logrotate.conf
/etc/logrotate.d/
```

Example:
```bash
/var/log/syslog {
    daily
    rotate 7
    compress
    missingok
    notifempty
}
```

Commands:
```bash
logrotate -d /etc/logrotate.conf
logrotate -f /etc/logrotate.conf
```

##  Troubleshooting Scenarios

SSH login failure:
```bash
grep "Failed password" /var/log/auth.log
```

Service not starting:
```bash
journalctl -u nginx
```

Disk usage:
```bash
du -sh /var/log/*
```

Kernel logs:
```bash
journalctl -k
```
